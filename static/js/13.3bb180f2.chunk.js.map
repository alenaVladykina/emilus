{"version":3,"sources":["views/app-views/main/scheduler/Area.js","views/app-views/main/scheduler/data.js","views/app-views/main/scheduler/Toolbar.js","views/app-views/main/scheduler/index.js"],"names":["Area","_ref","tables","refElement","handleMouseDown","handleMouseUp","tableList","map","_ref2","id","x","y","width","height","image","style","top","left","background","concat","_jsx","className","ref","onMouseDown","onMouseUp","children","dataTables","name","actions","type","Toolbar","exportFile","importFile","setCurrentAction","currentAction","toolbarActions","data","active","title","onClick","onClickAction","_jsxs","onChange","display","forEach","push","Map","isDrawing","setIsDrawing","useState","offsetX","setOffsetX","offsetY","setOffsetY","currentElement","setCurrentElement","useRef","setTables","useEffect","document","addEventListener","handleMouseMove","removeEventListener","event","clientX","clientY","areaCoords","current","getBoundingClientRect","posX","posY","xx","Math","max","min","offsetWidth","yy","offsetHeight","createTable","e","uuid","JSON","stringify","floor","blob","Blob","downloadUrl","window","URL","createObjectURL","link","createElement","href","download","dispatchEvent","MouseEvent","bubbles","cancelable","view","setTimeout","revokeObjectURL","remove","target","files","length","file","reader","FileReader","readAsText","onload","parse","result","table","find","onerror","console","log","error","nativeEvent"],"mappings":"4HA+BeA,MA7BFC,IAA2D,IAA1D,OAACC,EAAM,WAAEC,EAAU,gBAAEC,EAAe,cAAEC,GAAcJ,EAE9D,MAAMK,EAAYJ,EAAOK,KAAIC,IAAuC,IAAtC,GAACC,EAAE,EAAEC,EAAC,EAAEC,EAAC,MAAEC,EAAK,OAAEC,EAAM,MAAEC,GAAMN,EAE1D,MAAMO,EAAQ,CACVC,IAAKL,EAAI,KACTM,KAAMP,EAAI,KACVE,QACAC,SACCK,WAAW,wBAADC,OAA0BL,EAAK,MAG9C,OACIM,cAAA,OACKL,MAAOA,EACPM,UAAW,OAFNZ,EAEc,IAGhC,OACIW,cAAA,OAAKC,UAAU,OACVC,IAAKnB,EACLoB,YAAanB,EACboB,UAAWnB,EAAcoB,SAEzBnB,GACC,EC3BP,MAAMoB,EAAa,CACtB,CACId,MAAO,GACPC,OAAQ,IACRJ,GAAI,UACJkB,KAAM,yEACNb,MAAO,eAEX,CACIF,MAAO,IACPC,OAAQ,IACRJ,GAAI,UACJkB,KAAM,yEACNb,MAAO,eAEX,CACIF,MAAO,IACPC,OAAQ,IACRJ,GAAI,UACJkB,KAAM,yEACNb,MAAO,eAEX,CACIF,MAAO,IACPC,OAAQ,IACRJ,GAAI,UACJkB,KAAM,yEACNb,MAAO,gBAIFc,EAAU,CACnB,CACInB,GAAI,QACJkB,KAAM,qEACNE,KAAM,U,YCcCC,MA/CC7B,IAAyE,IAAxE,WAAC8B,EAAU,WAAEC,EAAU,iBAAEC,EAAgB,QAAEL,EAAO,cAAEM,GAAcjC,EAE/E,MAAMkC,EAAiBP,EAAQrB,KAAIC,IAA6B,IAA5B,GAACC,EAAE,KAAEkB,EAAI,KAAEE,EAAI,KAAEO,GAAK5B,EACtD,MAQM6B,EAAS5B,IAAOyB,EAAczB,GAAK,qBAAuB,GAGhE,OACIW,cAAA,UACQkB,MAAOX,EACPY,QAdUC,KAClBP,EAAiB,CACbxB,KACAoB,OACAO,QACF,EAUMf,UAAS,eAAAF,OAAiBkB,GAASZ,SACtCE,GAJQlB,EAKJ,IAIjB,OACIgC,eAAA,OAAKpB,UAAU,UAASI,SAAA,CACnBU,EACDf,cAAA,UACImB,QAASP,EACTX,UAAU,eAAcI,SAAC,WAG7BL,cAAA,OAAAK,SACIgB,eAAA,SAAAhB,SAAA,CACIL,cAAA,SAAOS,KAAK,OACLa,SAAUX,EACVhB,MAAO,CAAC4B,QAAS,UAExBvB,cAAA,OAAKC,UAAU,eAAcI,SAAC,kBAKpC,ECtCdC,EAAWkB,SAASR,IAChBR,EAAQiB,KAAK,CACTpC,GAAI2B,EAAK3B,GACTkB,KAAMS,EAAKT,KACXE,KAAM,SACNO,QACF,IAuJSU,UApJHA,KACR,MAAOC,EAAWC,GAAgBC,oBAAS,IACpCC,EAASC,GAAcF,mBAAS,IAChCG,EAASC,GAAcJ,mBAAS,IAChCK,EAAgBC,GAAqBN,mBAAS,OAC9Cf,EAAeD,GAAoBgB,mBAAS,CAAC,GAC9C3B,EAAMkC,iBAAO,OACZtD,EAAQuD,GAAaR,mBAAS,IAGrCS,qBAAU,KACFX,EACAY,SAASC,iBAAiB,YAAaC,GAEvCF,SAASG,oBAAoB,YAAaD,GAGvC,KACHF,SAASG,oBAAoB,YAAaD,EAAgB,IAE/D,CAACd,IAGJ,MAsBMc,EAAmBE,IACrB,GAAIhB,EAAW,CACX,MAAMrC,EAAIqD,EAAMC,QACVrD,EAAIoD,EAAME,QACVC,EAAa5C,EAAI6C,QAAQC,wBAEzBC,EAAO3D,EAAIwD,EAAWjD,KAAOiC,EAC7BoB,EAAO3D,EAAIuD,EAAWlD,IAAMoC,EAE5BmB,EAAKC,KAAKC,IAAI,EAAGD,KAAKE,IAAIL,EAAMH,EAAWtD,MAAQ0C,EAAeqB,cAClEC,EAAKJ,KAAKC,IAAI,EAAGD,KAAKE,IAAIJ,EAAMJ,EAAWrD,OAASyC,EAAeuB,eAEzEvB,EAAevC,MAAME,KAAOsD,EAAK,KACjCjB,EAAevC,MAAMC,IAAM4D,EAAK,IACpC,GAIEE,EAAeC,IACjB,MAAMb,EAAa5C,EAAI6C,QAAQC,yBACzB,MAACxD,EAAK,OAAEC,EAAM,MAAEC,EAAK,GAAEL,GAAMyB,EAAcE,KACjDqB,EAAU,IAAIvD,EACV,CACIO,GAAIuE,cACJtE,EAAGqE,EAAEf,QAAUE,EAAWjD,KAAOL,EAAQ,EACzCD,EAAGoE,EAAEd,QAAUC,EAAWlD,IAAMH,EAAS,EACzCD,QACAC,SACAC,QACAa,KAAMlB,IAEZ,EAwDN,OACIgC,eAAA,OAAKpB,UAAU,YAAWI,SAAA,CACtBL,cAACU,EAAO,CAACI,cAAeA,EACfD,iBAAkBA,EAClBL,QAASA,EACTI,WAzDEA,KACf,MAAMI,EAAO6C,KAAKC,UAAUhF,EAAOK,KAAIN,IAAA,IAAC,KAAC0B,EAAI,EAAEjB,EAAC,EAAEC,GAAEV,EAAA,MAAM,CAACQ,GAAIkB,EAAMjB,EAAG8D,KAAKW,MAAMzE,GAAIC,EAAG6D,KAAKW,MAAMxE,GAAG,KAClGyE,EAAO,IAAIC,KAAK,CAACjD,IACjBkD,EAAcC,OAAOC,IAAIC,gBAAgBL,GACzCM,EAAO/B,SAASgC,cAAc,KAEpCD,EAAKE,KAAON,EACZI,EAAKG,SAAW,cAEhBH,EAAKI,cACD,IAAIC,WAAW,QAAS,CACpBC,SAAS,EACTC,YAAY,EACZC,KAAMX,UAIdY,YAAW,KACPZ,OAAOC,IAAIY,gBAAgBd,GAC3BI,EAAKW,QAAQ,GACd,IAAI,EAsCMtE,WAnCGgD,IAChB,GAAIA,EAAEuB,OAAOC,OAASxB,EAAEuB,OAAOC,MAAMC,OAAQ,CACzC,MAAMC,EAAO1B,EAAEuB,OAAOC,MAAM,GACtBG,EAAS,IAAIC,WAEnBD,EAAOE,WAAWH,GAElBC,EAAOG,OAAS,WACZ,MAAMzE,EAAO6C,KAAK6B,MAAMJ,EAAOK,QAC/BtD,EAAUrB,EAAK7B,KAAIC,IAAiB,IAAhB,EAACE,EAAC,EAAEC,EAAC,GAAEF,GAAGD,EAC1B,MAAMwG,EAAQtF,EAAWuF,MAAMD,GAAUA,EAAMvG,KAAOA,IAEtD,MAAO,IACAuG,EACHvG,GAAIuE,cACJrD,KAAMqF,EAAMvG,GACZC,IACAC,IACH,IAET,EAEA+F,EAAOQ,QAAU,WACbC,QAAQC,IAAIV,EAAOW,MACvB,CACJ,KAWIjG,cAACpB,EAAI,CAACE,OAAQA,EACRG,cA5GS0E,IACQ,UAAvB7C,EAAcL,OACdmB,GAAa,GACbO,EAAkB,MAClBJ,EAAW,GACXE,EAAW,IAGY,WAAvBnB,EAAcL,MACdiD,EAAYC,EAChB,EAmGU5E,WAAYmB,EACZlB,gBAvHW2D,IACM,UAAvB7B,EAAcL,MAAoBkC,EAAMuC,QAAqC,QAA3BvC,EAAMuC,OAAOjF,YAC/D2B,GAAa,GACbO,EAAkBQ,EAAMuC,QACxBnD,EAAWY,EAAMuD,YAAYpE,SAC7BG,EAAWU,EAAMuD,YAAYlE,SACjC,MAmHM,C","file":"static/js/13.3bb180f2.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nconst Area = ({tables, refElement, handleMouseDown, handleMouseUp}) => {\r\n\r\n    const tableList = tables.map(({id, x, y, width, height, image}) => {\r\n\r\n        const style = {\r\n            top: y + \"px\",\r\n            left: x + \"px\",\r\n            width,\r\n            height,\r\n             background: `url(/jobs/img/tables/${image})`\r\n        }\r\n\r\n        return (\r\n            <div key={id}\r\n                 style={style}\r\n                 className={'box'}/>\r\n        )\r\n    })\r\n    return (\r\n        <div className='area'\r\n             ref={refElement}\r\n             onMouseDown={handleMouseDown}\r\n             onMouseUp={handleMouseUp}\r\n        >\r\n            {tableList}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Area;","export const dataTables = [\r\n    {\r\n        width: 80,\r\n        height: 100,\r\n        id: 'table_2',\r\n        name: 'Стол на 2 места',\r\n        image: 'table_2.png',\r\n    },\r\n    {\r\n        width: 110,\r\n        height: 100,\r\n        id: 'table_4',\r\n        name: 'Стол на 4 места',\r\n        image: 'table_4.png',\r\n    },\r\n    {\r\n        width: 150,\r\n        height: 130,\r\n        id: 'table_5',\r\n        name: 'Стол на 5 места',\r\n        image: 'table_5.png',\r\n    },\r\n    {\r\n        width: 230,\r\n        height: 130,\r\n        id: 'table_8',\r\n        name: 'Стол на 8 места',\r\n        image: 'table_8.png',\r\n    }\r\n];\r\n\r\nexport const actions = [\r\n    {\r\n        id: 'point',\r\n        name: 'Перемещение',\r\n        type: 'point',\r\n    }\r\n];","import React from 'react';\r\n\r\nconst Toolbar = ({exportFile, importFile, setCurrentAction, actions, currentAction}) => {\r\n\r\n    const toolbarActions = actions.map(({id, name, type, data}) => {\r\n        const onClickAction = () => {\r\n            setCurrentAction({\r\n                id,\r\n                type,\r\n                data\r\n            })\r\n        }\r\n\r\n        const active = id === currentAction.id ? 'toolbarItem_active' : ''\r\n\r\n\r\n        return (\r\n            <button key={id}\r\n                    title={name}\r\n                    onClick={onClickAction}\r\n                    className={`toolbarItem ${active}`}>\r\n                {name}\r\n            </button>\r\n        )\r\n    });\r\n\r\n    return (\r\n        <div className='toolbar'>\r\n            {toolbarActions}\r\n            <button\r\n                onClick={importFile}\r\n                className='buttonAction'>\r\n                Export\r\n            </button>\r\n            <div>\r\n                <label>\r\n                    <input type=\"file\"\r\n                           onChange={exportFile}\r\n                           style={{display: 'none'}}\r\n                    />\r\n                    <div className='buttonAction'>\r\n                        Import\r\n                    </div>\r\n                </label>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Toolbar;","import React, {useEffect, useRef, useState} from 'react';\r\nimport Area from \"./Area\";\r\nimport {actions, dataTables} from \"./data\";\r\nimport {uuid} from \"../../../../utils\";\r\nimport Toolbar from \"./Toolbar\";\r\n\r\n\r\ndataTables.forEach((data) => {\r\n    actions.push({\r\n        id: data.id,\r\n        name: data.name,\r\n        type: 'create',\r\n        data\r\n    });\r\n});\r\n\r\nconst Map = () => {\r\n    const [isDrawing, setIsDrawing] = useState(false);\r\n    const [offsetX, setOffsetX] = useState(0);\r\n    const [offsetY, setOffsetY] = useState(0);\r\n    const [currentElement, setCurrentElement] = useState(null);\r\n    const [currentAction, setCurrentAction] = useState({});\r\n    const ref = useRef(null);\r\n    const [tables, setTables] = useState([])\r\n\r\n\r\n    useEffect(() => {\r\n        if (isDrawing) {\r\n            document.addEventListener(\"mousemove\", handleMouseMove);\r\n        } else {\r\n            document.removeEventListener(\"mousemove\", handleMouseMove);\r\n        }\r\n\r\n        return () => {\r\n            document.removeEventListener(\"mousemove\", handleMouseMove);\r\n        }\r\n    }, [isDrawing])\r\n\r\n\r\n    const handleMouseDown = (event) => {\r\n        if (currentAction.type === \"point\" && event.target && event.target.className === 'box') {\r\n            setIsDrawing(true);\r\n            setCurrentElement(event.target);\r\n            setOffsetX(event.nativeEvent.offsetX);\r\n            setOffsetY(event.nativeEvent.offsetY);\r\n        }\r\n    };\r\n\r\n    const handleMouseUp = (e) => {\r\n        if (currentAction.type === \"point\") {\r\n            setIsDrawing(false);\r\n            setCurrentElement(null);\r\n            setOffsetX(0);\r\n            setOffsetY(0);\r\n        }\r\n\r\n        if (currentAction.type === \"create\") {\r\n            createTable(e);\r\n        }\r\n    };\r\n\r\n    const handleMouseMove = (event) => {\r\n        if (isDrawing) {\r\n            const x = event.clientX;\r\n            const y = event.clientY;\r\n            const areaCoords = ref.current.getBoundingClientRect();\r\n\r\n            const posX = x - areaCoords.left - offsetX;\r\n            const posY = y - areaCoords.top - offsetY;\r\n\r\n            const xx = Math.max(0, Math.min(posX, areaCoords.width - currentElement.offsetWidth));\r\n            const yy = Math.max(0, Math.min(posY, areaCoords.height - currentElement.offsetHeight));\r\n\r\n            currentElement.style.left = xx + 'px';\r\n            currentElement.style.top = yy + 'px';\r\n        }\r\n    };\r\n\r\n\r\n    const createTable = (e) => {\r\n        const areaCoords = ref.current.getBoundingClientRect();\r\n        const {width, height, image, id} = currentAction.data\r\n        setTables([...tables,\r\n            {\r\n                id: uuid(),\r\n                x: e.clientX - areaCoords.left - width / 2,\r\n                y: e.clientY - areaCoords.top - height / 2,\r\n                width,\r\n                height,\r\n                image,\r\n                name: id\r\n            }\r\n        ])\r\n    };\r\n\r\n\r\n    const importFile = () => {\r\n        const data = JSON.stringify(tables.map(({name, x, y}) => ({id: name, x: Math.floor(x), y: Math.floor(y)})))\r\n        const blob = new Blob([data]);\r\n        const downloadUrl = window.URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n\r\n        link.href = downloadUrl;\r\n        link.download = \"tables.json\";\r\n\r\n        link.dispatchEvent(\r\n            new MouseEvent('click', {\r\n                bubbles: true,\r\n                cancelable: true,\r\n                view: window\r\n            })\r\n        );\r\n\r\n        setTimeout(() => {\r\n            window.URL.revokeObjectURL(downloadUrl);\r\n            link.remove();\r\n        }, 100);\r\n    }\r\n\r\n    const exportFile = (e) => {\r\n        if (e.target.files && e.target.files.length) {\r\n            const file = e.target.files[0];\r\n            const reader = new FileReader();\r\n\r\n            reader.readAsText(file);\r\n\r\n            reader.onload = function () {\r\n                const data = JSON.parse(reader.result);\r\n                setTables(data.map(({x, y, id}) => {\r\n                    const table = dataTables.find((table) => table.id === id);\r\n\r\n                    return {\r\n                        ...table,\r\n                        id: uuid(),\r\n                        name: table.id,\r\n                        x,\r\n                        y,\r\n                    }\r\n                }));\r\n            };\r\n\r\n            reader.onerror = function () {\r\n                console.log(reader.error);\r\n            };\r\n        }\r\n    }\r\n\r\n\r\n    return (\r\n        <div className='scheduler'>\r\n            <Toolbar currentAction={currentAction}\r\n                     setCurrentAction={setCurrentAction}\r\n                     actions={actions}\r\n                     importFile={importFile}\r\n                     exportFile={exportFile}/>\r\n            <Area tables={tables}\r\n                  handleMouseUp={handleMouseUp}\r\n                  refElement={ref}\r\n                  handleMouseDown={handleMouseDown}/>\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Map;\r\n"],"sourceRoot":""}