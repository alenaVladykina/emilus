(this.webpackJsonpemilus=this.webpackJsonpemilus||[]).push([[13],{536:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n(5);var o=e=>{let{tables:t,refElement:n,handleMouseDown:i,handleMouseUp:o}=e;const s=t.map((e=>{let{id:t,x:n,y:i,width:o,height:s,image:c}=e;const l={top:i+"px",left:n+"px",width:o,height:s,background:'url("/img/tables/'.concat(c,'")')};return Object(a.jsx)("div",{style:l,className:"box"},t)}));return Object(a.jsx)("div",{className:"area",ref:n,onMouseDown:i,onMouseUp:o,children:s})};const s=[{width:80,height:100,id:"table_2",name:"\u0421\u0442\u043e\u043b \u043d\u0430 2 \u043c\u0435\u0441\u0442\u0430",image:"table_2.png"},{width:110,height:100,id:"table_4",name:"\u0421\u0442\u043e\u043b \u043d\u0430 4 \u043c\u0435\u0441\u0442\u0430",image:"table_4.png"},{width:150,height:130,id:"table_5",name:"\u0421\u0442\u043e\u043b \u043d\u0430 5 \u043c\u0435\u0441\u0442\u0430",image:"table_5.png"},{width:230,height:130,id:"table_8",name:"\u0421\u0442\u043e\u043b \u043d\u0430 8 \u043c\u0435\u0441\u0442\u0430",image:"table_8.png"}],c=[{id:"point",name:"\u041f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435",type:"point"}];var l=n(57);var r=e=>{let{exportFile:t,importFile:n,setCurrentAction:i,actions:o,currentAction:s}=e;const c=o.map((e=>{let{id:t,name:n,type:o,data:c}=e;const l=t===s.id?"toolbarItem_active":"";return Object(a.jsx)("button",{title:n,onClick:()=>{i({id:t,type:o,data:c})},className:"toolbarItem ".concat(l),children:n},t)}));return Object(a.jsxs)("div",{className:"toolbar",children:[c,Object(a.jsx)("button",{onClick:n,className:"buttonAction",children:"Export"}),Object(a.jsx)("div",{children:Object(a.jsxs)("label",{children:[Object(a.jsx)("input",{type:"file",onChange:t,style:{display:"none"}}),Object(a.jsx)("div",{className:"buttonAction",children:"Import"})]})})]})};s.forEach((e=>{c.push({id:e.id,name:e.name,type:"create",data:e})}));t.default=()=>{const[e,t]=Object(i.useState)(!1),[n,d]=Object(i.useState)(0),[u,m]=Object(i.useState)(0),[h,b]=Object(i.useState)(null),[p,g]=Object(i.useState)({}),j=Object(i.useRef)(null),[f,x]=Object(i.useState)([]);Object(i.useEffect)((()=>(e?document.addEventListener("mousemove",v):document.removeEventListener("mousemove",v),()=>{document.removeEventListener("mousemove",v)})),[e]);const v=t=>{if(e){const e=t.clientX,i=t.clientY,a=j.current.getBoundingClientRect(),o=e-a.left-n,s=i-a.top-u,c=Math.max(0,Math.min(o,a.width-h.offsetWidth)),l=Math.max(0,Math.min(s,a.height-h.offsetHeight));h.style.left=c+"px",h.style.top=l+"px"}},O=e=>{const t=j.current.getBoundingClientRect(),{width:n,height:i,image:a,id:o}=p.data;x([...f,{id:Object(l.b)(),x:e.clientX-t.left-n/2,y:e.clientY-t.top-i/2,width:n,height:i,image:a,name:o}])};return Object(a.jsxs)("div",{className:"scheduler",children:[Object(a.jsx)(r,{currentAction:p,setCurrentAction:g,actions:c,importFile:()=>{const e=JSON.stringify(f.map((e=>{let{name:t,x:n,y:i}=e;return{id:t,x:Math.floor(n),y:Math.floor(i)}}))),t=new Blob([e]),n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download="tables.json",i.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout((()=>{window.URL.revokeObjectURL(n),i.remove()}),100)},exportFile:e=>{if(e.target.files&&e.target.files.length){const t=e.target.files[0],n=new FileReader;n.readAsText(t),n.onload=function(){const e=JSON.parse(n.result);x(e.map((e=>{let{x:t,y:n,id:i}=e;const a=s.find((e=>e.id===i));return{...a,id:Object(l.b)(),name:a.id,x:t,y:n}})))},n.onerror=function(){console.log(n.error)}}}}),Object(a.jsx)(o,{tables:f,handleMouseUp:e=>{"point"===p.type&&(t(!1),b(null),d(0),m(0)),"create"===p.type&&O(e)},refElement:j,handleMouseDown:e=>{"point"===p.type&&e.target&&"box"===e.target.className&&(t(!0),b(e.target),d(e.nativeEvent.offsetX),m(e.nativeEvent.offsetY))}})]})}}}]);
//# sourceMappingURL=13.403dda22.chunk.js.map